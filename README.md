
```markdown
# üß™ RAG ChunkTester

**RAG ChunkTester** ‚Äî —ç—Ç–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ Retrieval-Augmented Generation —Å–∏—Å—Ç–µ–º. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —á–∞–Ω–∫–æ–≤–∞–Ω–∏—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞, –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ—Ç—Ä–∏–≤–µ—Ä–∞ –∏ –ø—Ä–æ–º–ø—Ç–∞.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```

chunktester/
‚îú‚îÄ‚îÄ main.py                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞: –∑–∞–ø—É—Å–∫ chunking, eval, sweep, summary
‚îú‚îÄ‚îÄ runners/                  # –ò—Å–ø–æ–ª–Ω—è—é—â–∏–µ –º–æ–¥—É–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ chunk\_and\_embed.py
‚îÇ   ‚îú‚îÄ‚îÄ eval\_runner.py
‚îÇ   ‚îî‚îÄ‚îÄ sweep\_runner.py
‚îú‚îÄ‚îÄ utils/                    # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ config\_loader.py
‚îÇ   ‚îú‚îÄ‚îÄ document\_loader.py
‚îÇ   ‚îú‚îÄ‚îÄ chunking.py
‚îÇ   ‚îú‚îÄ‚îÄ embedding.py
‚îÇ   ‚îú‚îÄ‚îÄ retriever.py
‚îÇ   ‚îî‚îÄ‚îÄ logger.py
‚îú‚îÄ‚îÄ cleaners/                 # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —á–∞–Ω–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ chunk\_cleaner.py
‚îú‚îÄ‚îÄ scorers/
‚îÇ   ‚îî‚îÄ‚îÄ llm\_scorer.py         # –û—Ü–µ–Ω–∫–∞ –æ—Ç–≤–µ—Ç–∞ (+1 / 0 / -1)
‚îú‚îÄ‚îÄ prompts/
‚îÇ   ‚îî‚îÄ‚îÄ system\_prompt.txt     # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è LLM
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îú‚îÄ‚îÄ eval\_config.yaml      # –ö–æ–Ω—Ñ–∏–≥ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞
‚îÇ   ‚îú‚îÄ‚îÄ sweep\_grid.yaml       # Grid-–ø–µ—Ä–µ–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ settings.py           # –ö–ª—é—á–∏ –∏ –ø—Ä–æ–∫—Å–∏ –∏–∑ .env
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ source\_docs/          # –î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è —á–∞–Ω–∫–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ queries.jsonl         # –í–æ–ø—Ä–æ—Å—ã + –æ–∂–∏–¥–∞–µ–º—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
‚îú‚îÄ‚îÄ embeddings/               # –•—Ä–∞–Ω–∏–ª–∏—â–µ ChromaDB (–æ–¥–Ω–∞ –ø–∞–ø–∫–∞ –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—É—Å–∫)
‚îú‚îÄ‚îÄ results/                  # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ü–µ–Ω–æ–∫ (–æ–¥–Ω–∞ –ø–∞–ø–∫–∞ –Ω–∞ –∑–∞–ø—É—Å–∫)
‚îú‚îÄ‚îÄ .env                      # API –∫–ª—é—á–∏ –∏ –æ–ø—Ü–∏–∏
‚îú‚îÄ‚îÄ .gitignore
‚îî‚îÄ‚îÄ requirements.txt

````

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–æ–∑–¥–∞–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**

```bash
python -m venv venv
source venv/bin/activate # for Unix
.\venv\Scripts\activate.bat # for windows
pip install -r requirements.txt
````

2. **–ù–∞—Å—Ç—Ä–æ–π `.env` —Å –∫–ª—é—á–∞–º–∏:**

```env
OPENAI_API_KEY=sk-...
USE_PROXY=false
PROXY_URL=http://localhost:8080
OPENAI_MODEL=gpt-4
```

3. **–ü–æ–ª–æ–∂–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ `data/source_docs/`** (`.txt`, `.md`, –∏ —Ç.–¥.)

4. **–û–ø—Ä–µ–¥–µ–ª–∏ –∑–∞–ø—Ä–æ—Å—ã –≤ `data/queries.jsonl`:**

```json
{"query": "–ö—Ç–æ —Ç–∞–∫–æ–π –ú–∏—Å—Ç–µ—Ä –ò–∫—Å?", "expected_keywords": ["–¥–∏—Ä–µ–∫—Ç–æ—Ä", "–∞–Ω–∞–ª–∏—Ç–∏–∫–∏"]}
```

5. **–£–±–µ–¥–∏—Å—å, —á—Ç–æ –µ—Å—Ç—å `prompts/system_prompt.txt` —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π**

---

## üß™ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤ - positive/nagative/hallucination

```bash
python generate_questions.py
```bash

---

## üß™ –û–¥–∏–Ω —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç

```bash
python main.py run_chunk --config configs/eval_config.yaml
python generate_questions.py
python main.py run_eval  --config configs/eval_config.yaml
python main.py summary
python main.py show_fails
python main.py run_eval --config configs/eval_config.yaml --queries data/failed_queries.jsonl
```

---

## üîÅ –ú–Ω–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ (sweep)

```bash
python main.py run_sweep --sweep configs/sweep_zip.yaml
python main.py summary
```

---

## üìä –û—Ü–µ–Ω–∫–∞

–ú–µ—Ç—Ä–∏–∫–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞:

* `+1` ‚Äî –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –Ω–∞–π–¥–µ–Ω—ã –≤ –æ—Ç–≤–µ—Ç–µ
* `0` ‚Äî –Ω–∞–π–¥–µ–Ω–∞ —á–∞—Å—Ç—å –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
* `-1` ‚Äî –Ω–∏ –æ–¥–Ω–æ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ

–í—ã–≤–æ–¥–∏—Ç—Å—è:

```text
=== Summary ===
‚úÖ sweep_a1655fdd: acc=0.87, halluc=0.00 | +1=13, 0=1, -1=1
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

* `run_chunk` **–≤—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é** (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π `run_id`)
* `run_eval` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç `run_id`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–∫—É—â–µ–º—É –∫–æ–Ω—Ñ–∏–∫—É
* –µ—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è ‚Äî –º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å `run_eval` –±–µ–∑ `run_chunk`

---

## üìå –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

* [ ] –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –ø–æ hash –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
* [ ] LLM-–ø—Ä–æ–≤–µ—Ä–∫–∞ ¬´–≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π¬ª (–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π off-context response)
* [ ] –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ sweep-–ø—Ä–æ–≥–æ–Ω–æ–≤
* [ ] –û–±—ë—Ä—Ç–∫–∞ `run_all` –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

---

## ü§ù –ê–≤—Ç–æ—Ä

–°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è RAG-—Å–∏—Å—Ç–µ–º.
–í–æ–ø—Ä–æ—Å—ã: [e-mail:alx1379@gmail.com]

```

---
```
